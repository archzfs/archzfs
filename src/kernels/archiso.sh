# For build.sh
mode_name="iso"
mode_desc="Select and use the packages for the archiso linux kernel"

# Kernel versions for LTS packages
pkgrel="1"
kernel_version="4.12"
kernel_version_max=$(echo ${kernel_version}| awk -F. '{print $1"."$2+1}')

header="\
# Maintainer: Jesus Alvarez <jeezusjr at gmail dot com>
#
# This PKGBUILD was generated by the archzfs build scripts located at
#
# http://github.com/archzfs/archzfs
#
# ! WARNING !
#
# The archzfs packages are kernel modules, so these PKGBUILDS will only work with the kernel package they target. In this
# case, the archzfs-archiso-linux packages will only work with the archiso ISO! To have a single PKGBUILD target many kernels
# would make for a cluttered PKGBUILD!
#
# If you have a custom kernel, you will need to change things in the PKGBUILDS. If you would like to have AUR or archzfs repo
# packages for your favorite kernel package built using the archzfs build tools, submit a request in the Issue tracker on the
# archzfs github page.
#
#"

update_archiso_linux_pkgbuilds() {
    pkg_list=("spl-archiso-linux" "zfs-archiso-linux")
    kernel_mod_path="extramodules-${kernel_version}-ARCH"
    archzfs_package_group="archzfs-archiso-linux"
    kernel_version_full=$(kernel_version_full ${kernel_version})
    spl_pkgver=${zol_version}.${kernel_version_full}
    zfs_pkgver=${zol_version}.${kernel_version_full}
    spl_pkgrel=${pkgrel}
    zfs_pkgrel=${pkgrel}
    spl_utils_pkgname="spl-utils-common>=${zol_version}"
    spl_pkgname="spl-archiso-linux"
    zfs_utils_pkgname="zfs-utils-common>=${zol_version}"
    zfs_pkgname="zfs-archiso-linux"
    spl_pkgbuild_path="packages/${kernel_name}/${spl_pkgname}"
    zfs_pkgbuild_path="packages/${kernel_name}/${zfs_pkgname}"
    spl_src_target="https://github.com/zfsonlinux/zfs/releases/download/zfs-${zol_version}/spl-${zol_version}.tar.gz"
    zfs_src_target="https://github.com/zfsonlinux/zfs/releases/download/zfs-${zol_version}/zfs-${zol_version}.tar.gz"
    spl_workdir="\${srcdir}/spl-${zol_version}"
    zfs_workdir="\${srcdir}/zfs-${zol_version}"
    linux_depends="\"linux>=${kernel_version}\" \"linux<${kernel_version_max}\""
    linux_headers_depends="\"linux-headers>=${kernel_version}\" \"linux-headers<${kernel_version_max}\""
    zfs_makedepends="\"${spl_pkgname}-headers\""
}
